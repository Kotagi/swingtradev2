# Project README

*Auto-generated by `generate_readme.py`*

## Quickstart

```bash
python src/download_data.py --tickers data/tickers/sp500_tickers.csv
python src/clean_data.py
run_features_labels.bat
python src/train_model.py
```

```
bats/
  ├─ run_feature_pipeline.bat
config/
  ├─ features.yaml
  ├─ test_tickers.yaml
  ├─ train_features.yaml
data/
  ├─ clean/
  ├─ features_labeled/
  ├─ raw/
  ├─ tickers/
    ├─ Archive/
features/
  ├─ __init__.py
  ├─ registry.py
  ├─ technical.py
models/
notebooks/
reports/
  ├─ trade_logs/
scripts/
  ├─ audit_cleaned.py
src/
  ├─ Archive/
  ├─ __init__.py
  ├─ backtest.py
  ├─ clean_data.py
  ├─ clean_features_labeled.py
  ├─ download_data.py
  ├─ feature_pipeline.py
  ├─ train_model.py
tests/
  ├─ archive/
    ├─ test_clean_data.py
    ├─ test_features.py
    ├─ test_features_base.py
    ├─ test_labeling.py
utils/
  ├─ __init__.py
  ├─ labeling.py
  ├─ logger.py
clean_features.bat
readme_generator.py
redownload_and_clean.bat
run_features_labels.bat
```

## Dependencies

**requirements.txt:**
- `pandas>=1.3`
- `numpy>=1.21`
- `requests>=2.25`
- `pytest>=7.0`
- `python-dotenv>=0.19`
- `tabulate>=0.8.9`
- `matplotlib>=3.4`


## Config Files

- **config\features.yaml**: pipeline feature toggles (keys: features)
- **config\test_tickers.yaml**:  (keys: test_tickers)
- **config\train_features.yaml**: training feature toggles (keys: features)


## CLI Reference

### `src\download_data.py`

| Flag | Help | Default |
| ---- | ---- | ------- |
| `--tickers-file, -f` | One ticker per line | 'data/tickers/sp500_tickers.csv' |
| `--start-date, -s` | Start date for historical download (YYYY-MM-DD) | '2008-01-01' |
| `--end-date, -e` | End date for historical download (YYYY-MM-DD), defaults to today | None |
| `--raw-folder, -r` | Directory to save raw CSV files | 'data/raw' |
| `--sectors-file, -o` | Output CSV file for ticker–sector mapping | 'data/tickers/sectors.csv' |

### `src\feature_pipeline.py`

| Flag | Help | Default |
| ---- | ---- | ------- |
| `--input-dir` | Directory of cleaned CSVs | - |
| `--output-dir` | Directory to write feature CSVs | - |
| `--config` | Path to feature toggles YAML | - |
| `--horizon` | Label horizon in days | 5 |
| `--threshold` | Return threshold for labeling | 0.0 |


## Modules

### `src\backtest.py`
backtest.py
**Functions:**
- `load_universe()`
- `backtest_signals(df, signal_col)`  
  Given a DataFrame and a boolean signal column, return a trades DataFrame with:
- `aggregate_results(trades)`  
  Compute summary metrics for a set of trades.
- `main()`

### `src\clean_data.py`
**Functions:**
- `clean_file(path)`
- `main()`

### `src\clean_features_labeled.py`
clean_features_labeled.py
**Functions:**
- `clean_file(path)`
- `main()`

### `src\download_data.py`
download_data.py
**Functions:**
- `download_data(tickers, start_date, end_date, raw_folder)`  
  Downloads price data for each ticker and saves to raw_folder/<ticker>.csv.
- `write_sectors_csv(sectors, sectors_file)`  
  Writes sectors.csv with columns: ticker,sector
- `main()`

### `src\feature_pipeline.py`
**Functions:**
- `apply_features(df, enabled_features, logger)`  
  Apply each enabled feature function to the DataFrame.
- `main(input_dir, output_dir, config, label_horizon, label_threshold)`

### `src\train_model.py`
train_model.py
**Functions:**
- `load_data()`  
  Load all ticker CSVs from DATA_DIR into a single DataFrame.
- `prepare(df)`  
  Drop rows with any NaNs and split into features X and target y.
- `main()`

### `utils\labeling.py`
**Functions:**
- `label_future_return(df, close_col, horizon, threshold, label_name)`  
  Adds a binary label: 1 if forward (horizon)-day return > threshold, else 0.

### `utils\logger.py`
Logging configuration for feature pipeline and other modules.
**Functions:**
- `setup_logger(name, log_file, level)`  
  Set up and return a logger instance that logs to both console and file.

### `features\registry.py`
**Functions:**
- `load_enabled_features(config_path)`  
  Read config/features.yaml and return a dict of {feature_name: function}

### `features\technical.py`
**Functions:**
- `_get_close_series(df)`
- `feature_5d_return(df)`
- `feature_10d_return(df)`
- `feature_atr(df, period)`
- `feature_bb_width(df, period, std_dev)`
- `feature_ema_cross(df, span_short, span_long)`
- `feature_obv(df)`
- `feature_obv_pct(df)`  
  Daily percent change of OBV.
- `feature_obv_zscore(df, window)`  
  OBV relative to rolling mean.
- `feature_rsi(df, period)`
- `feature_sma_5(df)`  
  5-day simple moving average of close.
- `feature_ema_5(df)`  
  5-day exponential moving average of close.
- `feature_sma_10(df)`  
  10-day simple moving average of close.
- `feature_ema_10(df)`  
  10-day exponential moving average of close.
- `feature_sma_50(df)`  
  50-day simple moving average of close.
- `feature_ema_50(df)`  
  50-day exponential moving average of close.

---
## Enabled Features

- **10d_return**: ✅
- **5d_return**: ✅
- **atr**: ✅
- **bb_width**: ✅
- **ema_10**: ✅
- **ema_5**: ✅
- **ema_50**: ✅
- **ema_cross**: ✅
- **obv**: ✅
- **obv_pct**: ✅
- **obv_z20**: ✅
- **rsi**: ✅
- **sma_10**: ✅
- **sma_5**: ✅
- **sma_50**: ✅

